/* Editor CSS - Markdown Editor Styles */

/* CSS Variables for theming */
:root {
  /* Editor colors */
  --editor-bg: #1e1e2e;
  --editor-fg: #cdd6f4;
  --editor-gutter-bg: #181825;
  --editor-gutter-fg: #6c7086;
  --editor-line-highlight: rgba(69, 71, 90, 0.3);
  --editor-selection: rgba(137, 180, 250, 0.2);
  --editor-cursor: #f5e0dc;
  --editor-border: #313244;

  /* Syntax highlighting - Catppuccin Mocha inspired */
  --syntax-keyword: #cba6f7;
  --syntax-string: #a6e3a1;
  --syntax-number: #fab387;
  --syntax-comment: #6c7086;
  --syntax-function: #89b4fa;
  --syntax-variable: #f5e0dc;
  --syntax-operator: #89dceb;
  --syntax-heading: #f38ba8;
  --syntax-link: #89b4fa;
  --syntax-bold: #f5c2e7;
  --syntax-italic: #cba6f7;
  --syntax-code: #a6e3a1;
  --syntax-quote: #bac2de;
  --syntax-list: #fab387;

  /* Toolbar colors */
  --toolbar-bg: #1e1e2e;
  --toolbar-border: #313244;
  --toolbar-btn-bg: transparent;
  --toolbar-btn-hover: #313244;
  --toolbar-btn-active: #45475a;
  --toolbar-btn-fg: #cdd6f4;
  --toolbar-btn-fg-hover: #f5e0dc;
  --toolbar-divider: #313244;

  /* Preview colors */
  --preview-bg: #1e1e2e;
  --preview-fg: #cdd6f4;
  --preview-heading: #f5e0dc;
  --preview-link: #89b4fa;
  --preview-link-hover: #b4befe;
  --preview-code-bg: #181825;
  --preview-code-fg: #a6e3a1;
  --preview-blockquote-border: #cba6f7;
  --preview-blockquote-bg: rgba(203, 166, 247, 0.1);
  --preview-hr: #313244;
  --preview-table-border: #313244;
  --preview-table-header-bg: #181825;

  /* Pane layout */
  --pane-divider-width: 4px;
  --pane-divider-color: #313244;
  --pane-divider-hover: #89b4fa;

  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-normal: 250ms ease;
}

/* Light theme */
[data-theme="light"] {
  --editor-bg: #eff1f5;
  --editor-fg: #4c4f69;
  --editor-gutter-bg: #e6e9ef;
  --editor-gutter-fg: #8c8fa1;
  --editor-line-highlight: rgba(172, 176, 190, 0.3);
  --editor-selection: rgba(30, 102, 245, 0.2);
  --editor-cursor: #dc8a78;
  --editor-border: #ccd0da;

  --syntax-keyword: #8839ef;
  --syntax-string: #40a02b;
  --syntax-number: #fe640b;
  --syntax-comment: #8c8fa1;
  --syntax-function: #1e66f5;
  --syntax-variable: #dc8a78;
  --syntax-operator: #179299;
  --syntax-heading: #d20f39;
  --syntax-link: #1e66f5;
  --syntax-bold: #ea76cb;
  --syntax-italic: #8839ef;
  --syntax-code: #40a02b;
  --syntax-quote: #6c6f85;
  --syntax-list: #fe640b;

  --toolbar-bg: #eff1f5;
  --toolbar-border: #ccd0da;
  --toolbar-btn-bg: transparent;
  --toolbar-btn-hover: #ccd0da;
  --toolbar-btn-active: #bcc0cc;
  --toolbar-btn-fg: #4c4f69;
  --toolbar-btn-fg-hover: #dc8a78;

  --preview-bg: #eff1f5;
  --preview-fg: #4c4f69;
  --preview-heading: #dc8a78;
  --preview-link: #1e66f5;
  --preview-link-hover: #7287fd;
  --preview-code-bg: #e6e9ef;
  --preview-code-fg: #40a02b;
  --preview-blockquote-border: #8839ef;
  --preview-blockquote-bg: rgba(136, 57, 239, 0.1);
  --preview-hr: #ccd0da;
  --preview-table-border: #ccd0da;
  --preview-table-header-bg: #e6e9ef;

  --pane-divider-color: #ccd0da;
  --pane-divider-hover: #1e66f5;
}

/* ============================================
   Editor Container
   ============================================ */

.editor-pane {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  background: var(--editor-bg);
  overflow: hidden;
}

.editor-pane__content {
  display: flex;
  flex: 1;
  min-height: 0;
  position: relative;
}

.editor-pane__editor-wrapper,
.editor-pane__preview-wrapper {
  flex: 1;
  min-width: 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.editor-pane__editor-wrapper {
  border-right: 1px solid var(--editor-border);
}

/* Split layout modes */
.editor-pane--edit-only .editor-pane__preview-wrapper,
.editor-pane--edit-only .editor-pane__divider {
  display: none;
}

.editor-pane--edit-only .editor-pane__editor-wrapper {
  border-right: none;
}

.editor-pane--preview-only .editor-pane__editor-wrapper,
.editor-pane--preview-only .editor-pane__divider {
  display: none;
}

/* Resizable divider */
.editor-pane__divider {
  width: var(--pane-divider-width);
  background: var(--pane-divider-color);
  cursor: col-resize;
  flex-shrink: 0;
  transition: background-color var(--transition-fast);
  position: relative;
}

.editor-pane__divider:hover,
.editor-pane__divider--dragging {
  background: var(--pane-divider-hover);
}

.editor-pane__divider::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  left: -4px;
  right: -4px;
}

/* ============================================
   Editor Toolbar
   ============================================ */

.editor-toolbar {
  display: flex;
  align-items: center;
  gap: 2px;
  padding: 6px 12px;
  background: var(--toolbar-bg);
  border-bottom: 1px solid var(--toolbar-border);
  flex-wrap: wrap;
}

.editor-toolbar__group {
  display: flex;
  align-items: center;
  gap: 2px;
}

.editor-toolbar__divider {
  width: 1px;
  height: 24px;
  background: var(--toolbar-divider);
  margin: 0 6px;
}

.editor-toolbar__btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: none;
  border-radius: 4px;
  background: var(--toolbar-btn-bg);
  color: var(--toolbar-btn-fg);
  font-size: 14px;
  cursor: pointer;
  transition: all var(--transition-fast);
}

.editor-toolbar__btn:hover {
  background: var(--toolbar-btn-hover);
  color: var(--toolbar-btn-fg-hover);
}

.editor-toolbar__btn:active,
.editor-toolbar__btn--active {
  background: var(--toolbar-btn-active);
}

.editor-toolbar__btn:focus-visible {
  outline: 2px solid var(--preview-link);
  outline-offset: 1px;
}

.editor-toolbar__btn[disabled] {
  opacity: 0.5;
  cursor: not-allowed;
}

.editor-toolbar__btn svg {
  width: 18px;
  height: 18px;
}

/* Dropdown for heading levels */
.editor-toolbar__dropdown {
  position: relative;
}

.editor-toolbar__dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  min-width: 120px;
  padding: 4px;
  margin-top: 4px;
  background: var(--toolbar-bg);
  border: 1px solid var(--toolbar-border);
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.editor-toolbar__dropdown-item {
  display: block;
  width: 100%;
  padding: 8px 12px;
  border: none;
  border-radius: 4px;
  background: transparent;
  color: var(--toolbar-btn-fg);
  font-size: 14px;
  text-align: left;
  cursor: pointer;
  transition: background-color var(--transition-fast);
}

.editor-toolbar__dropdown-item:hover {
  background: var(--toolbar-btn-hover);
}

/* View mode toggle */
.editor-toolbar__view-toggle {
  display: flex;
  gap: 2px;
  margin-left: auto;
  padding: 2px;
  background: var(--toolbar-btn-hover);
  border-radius: 6px;
}

/* ============================================
   CodeMirror Editor
   ============================================ */

.markdown-editor {
  flex: 1;
  min-height: 0;
  overflow: hidden;
}

.markdown-editor .cm-editor {
  height: 100%;
  font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Consolas, monospace;
  font-size: 14px;
  line-height: 1.6;
}

.markdown-editor .cm-editor.cm-focused {
  outline: none;
}

.markdown-editor .cm-scroller {
  overflow: auto;
  font-family: inherit;
}

.markdown-editor .cm-content {
  padding: 16px;
  caret-color: var(--editor-cursor);
}

.markdown-editor .cm-line {
  padding: 0 4px;
}

/* Gutters */
.markdown-editor .cm-gutters {
  background: var(--editor-gutter-bg);
  color: var(--editor-gutter-fg);
  border-right: 1px solid var(--editor-border);
}

.markdown-editor .cm-lineNumbers .cm-gutterElement {
  padding: 0 12px 0 8px;
  min-width: 40px;
  text-align: right;
}

.markdown-editor .cm-activeLineGutter {
  background: var(--editor-line-highlight);
}

/* Active line */
.markdown-editor .cm-activeLine {
  background: var(--editor-line-highlight);
}

/* Selection */
.markdown-editor .cm-selectionBackground {
  background: var(--editor-selection) !important;
}

.markdown-editor .cm-focused .cm-selectionBackground {
  background: var(--editor-selection) !important;
}

/* Cursor */
.markdown-editor .cm-cursor {
  border-left-color: var(--editor-cursor);
  border-left-width: 2px;
}

/* Search highlight */
.markdown-editor .cm-searchMatch {
  background: rgba(250, 179, 135, 0.3);
  border-radius: 2px;
}

.markdown-editor .cm-searchMatch.cm-searchMatch-selected {
  background: rgba(250, 179, 135, 0.5);
}

/* Markdown syntax highlighting */
.markdown-editor .cm-header {
  color: var(--syntax-heading);
  font-weight: 600;
}

.markdown-editor .cm-header-1 { font-size: 1.5em; }
.markdown-editor .cm-header-2 { font-size: 1.35em; }
.markdown-editor .cm-header-3 { font-size: 1.2em; }
.markdown-editor .cm-header-4 { font-size: 1.1em; }
.markdown-editor .cm-header-5 { font-size: 1.05em; }
.markdown-editor .cm-header-6 { font-size: 1em; }

.markdown-editor .cm-strong {
  color: var(--syntax-bold);
  font-weight: 700;
}

.markdown-editor .cm-emphasis,
.markdown-editor .cm-em {
  color: var(--syntax-italic);
  font-style: italic;
}

.markdown-editor .cm-strikethrough {
  text-decoration: line-through;
  color: var(--syntax-comment);
}

.markdown-editor .cm-link {
  color: var(--syntax-link);
  text-decoration: underline;
}

.markdown-editor .cm-url {
  color: var(--syntax-link);
  opacity: 0.8;
}

.markdown-editor .cm-comment,
.markdown-editor .cm-meta {
  color: var(--syntax-comment);
}

.markdown-editor .cm-quote {
  color: var(--syntax-quote);
  font-style: italic;
}

.markdown-editor .cm-list {
  color: var(--syntax-list);
}

/* Inline code */
.markdown-editor .cm-monospace,
.markdown-editor .cm-inlineCode {
  font-family: 'JetBrains Mono', monospace;
  color: var(--syntax-code);
  background: rgba(166, 227, 161, 0.1);
  padding: 1px 4px;
  border-radius: 3px;
}

/* Code blocks */
.markdown-editor .cm-codeBlock {
  font-family: 'JetBrains Mono', monospace;
  color: var(--syntax-code);
}

/* Fenced code language tag */
.markdown-editor .cm-codeLang {
  color: var(--syntax-function);
}

/* Horizontal rule */
.markdown-editor .cm-hr {
  color: var(--syntax-comment);
}

/* Task list checkboxes */
.markdown-editor .cm-taskMarker {
  color: var(--syntax-list);
}

/* ============================================
   Markdown Preview
   ============================================ */

.markdown-preview {
  flex: 1;
  min-height: 0;
  overflow: auto;
  padding: 24px 32px;
  background: var(--preview-bg);
  color: var(--preview-fg);
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-size: 16px;
  line-height: 1.75;
}

/* Typography */
.markdown-preview h1,
.markdown-preview h2,
.markdown-preview h3,
.markdown-preview h4,
.markdown-preview h5,
.markdown-preview h6 {
  color: var(--preview-heading);
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  font-weight: 600;
  line-height: 1.3;
}

.markdown-preview h1:first-child,
.markdown-preview h2:first-child,
.markdown-preview h3:first-child {
  margin-top: 0;
}

.markdown-preview h1 { font-size: 2em; }
.markdown-preview h2 { font-size: 1.5em; }
.markdown-preview h3 { font-size: 1.25em; }
.markdown-preview h4 { font-size: 1.1em; }
.markdown-preview h5 { font-size: 1em; }
.markdown-preview h6 { font-size: 0.9em; }

.markdown-preview p {
  margin: 0 0 1em;
}

.markdown-preview strong {
  font-weight: 700;
}

.markdown-preview em {
  font-style: italic;
}

.markdown-preview del {
  text-decoration: line-through;
  opacity: 0.7;
}

/* Links */
.markdown-preview a {
  color: var(--preview-link);
  text-decoration: none;
  transition: color var(--transition-fast);
}

.markdown-preview a:hover {
  color: var(--preview-link-hover);
  text-decoration: underline;
}

/* Lists */
.markdown-preview ul,
.markdown-preview ol {
  margin: 0 0 1em;
  padding-left: 1.5em;
}

.markdown-preview li {
  margin: 0.25em 0;
}

.markdown-preview li > ul,
.markdown-preview li > ol {
  margin: 0.25em 0;
}

/* Task lists */
.markdown-preview ul.contains-task-list {
  list-style: none;
  padding-left: 0;
}

.markdown-preview li.task-list-item {
  display: flex;
  align-items: flex-start;
  gap: 8px;
}

.markdown-preview li.task-list-item input[type="checkbox"] {
  margin-top: 6px;
  width: 16px;
  height: 16px;
  accent-color: var(--preview-link);
}

/* Blockquotes */
.markdown-preview blockquote {
  margin: 0 0 1em;
  padding: 12px 16px;
  border-left: 4px solid var(--preview-blockquote-border);
  background: var(--preview-blockquote-bg);
  border-radius: 0 6px 6px 0;
}

.markdown-preview blockquote p:last-child {
  margin-bottom: 0;
}

/* Code */
.markdown-preview code {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  font-size: 0.9em;
  padding: 2px 6px;
  background: var(--preview-code-bg);
  color: var(--preview-code-fg);
  border-radius: 4px;
}

.markdown-preview pre {
  margin: 0 0 1em;
  padding: 16px;
  background: var(--preview-code-bg);
  border-radius: 8px;
  overflow-x: auto;
}

.markdown-preview pre code {
  padding: 0;
  background: transparent;
  font-size: 14px;
  line-height: 1.5;
}

/* Tables */
.markdown-preview table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--preview-table-border);
  border-radius: 8px;
  overflow: hidden;
}

.markdown-preview th,
.markdown-preview td {
  padding: 10px 14px;
  border: 1px solid var(--preview-table-border);
  text-align: left;
}

.markdown-preview th {
  background: var(--preview-table-header-bg);
  font-weight: 600;
}

.markdown-preview tr:nth-child(even) {
  background: rgba(0, 0, 0, 0.05);
}

/* Horizontal rule */
.markdown-preview hr {
  margin: 2em 0;
  border: none;
  border-top: 2px solid var(--preview-hr);
}

/* Images */
.markdown-preview img {
  max-width: 100%;
  height: auto;
  border-radius: 8px;
}

/* Math (KaTeX) */
.markdown-preview .math {
  overflow-x: auto;
  padding: 4px 0;
}

.markdown-preview .math-display {
  display: block;
  text-align: center;
  margin: 1em 0;
}

/* Whiteboard embed block */
.markdown-preview .whiteboard-block {
  margin: 1em 0;
  border: 2px solid var(--editor-border);
  border-radius: 8px;
  overflow: hidden;
  background: var(--editor-bg);
}

.markdown-preview .whiteboard-block__header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--toolbar-bg);
  border-bottom: 1px solid var(--editor-border);
  font-size: 12px;
  color: var(--syntax-comment);
}

.markdown-preview .whiteboard-block__content {
  position: relative;
  min-height: 200px;
  cursor: pointer;
}

.markdown-preview .whiteboard-block__placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 200px;
  color: var(--syntax-comment);
  font-size: 14px;
}

.markdown-preview .whiteboard-block:hover {
  border-color: var(--preview-link);
}

/* ============================================
   Scrollbar Styling
   ============================================ */

.markdown-editor .cm-scroller::-webkit-scrollbar,
.markdown-preview::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

.markdown-editor .cm-scroller::-webkit-scrollbar-track,
.markdown-preview::-webkit-scrollbar-track {
  background: transparent;
}

.markdown-editor .cm-scroller::-webkit-scrollbar-thumb,
.markdown-preview::-webkit-scrollbar-thumb {
  background: var(--editor-border);
  border-radius: 5px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

.markdown-editor .cm-scroller::-webkit-scrollbar-thumb:hover,
.markdown-preview::-webkit-scrollbar-thumb:hover {
  background: var(--syntax-comment);
  background-clip: padding-box;
}

/* ============================================
   Accessibility
   ============================================ */

/* Focus indicators */
.markdown-editor:focus-within {
  outline: 2px solid var(--preview-link);
  outline-offset: -2px;
}

/* Screen reader only */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .editor-toolbar__btn,
  .editor-pane__divider,
  .markdown-preview a {
    transition: none;
  }
}

/* ============================================
   Responsive
   ============================================ */

@media (max-width: 768px) {
  .editor-pane__content {
    flex-direction: column;
  }

  .editor-pane__editor-wrapper {
    border-right: none;
    border-bottom: 1px solid var(--editor-border);
  }

  .editor-pane__divider {
    width: 100%;
    height: var(--pane-divider-width);
    cursor: row-resize;
  }

  .markdown-preview {
    padding: 16px;
  }

  .editor-toolbar {
    padding: 4px 8px;
  }

  .editor-toolbar__btn {
    width: 28px;
    height: 28px;
  }
}
